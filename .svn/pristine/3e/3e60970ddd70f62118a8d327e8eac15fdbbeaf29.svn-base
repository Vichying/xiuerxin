(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-546a226a"],{"0d46":function(e,t,n){"use strict";var i=n("775e"),a=n.n(i);a.a},"2fd1":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"query warp"},[n("div",{staticClass:"title"},[e._v("当前 >> "+e._s(this.$store.state.titles))]),n("div",{staticClass:"main"},[n("span",[n("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"操作人"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}})],1),n("span",[e._v(" 操作板块： "),n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.Types,(function(e){return n("el-option",{key:e.id,attrs:{label:e.menu_name,value:e.menu_code}})})),1)],1),n("span",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.Bind(1)}}},[e._v("搜索")])],1),n("span",[n("el-button",{attrs:{type:"primary"},on:{click:e.Refush}},[e._v("刷新")])],1),n("div",{staticClass:"table"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[n("el-table-column",{attrs:{prop:"plate",align:"center",label:"操作板块"}}),n("el-table-column",{attrs:{align:"center",prop:"content",label:"操作内容"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{domProps:{innerHTML:e._s(e.contentZh(t.row.action,t.row.content))}})]}}])}),n("el-table-column",{attrs:{align:"center",prop:"user",label:"操作人"}}),n("el-table-column",{attrs:{align:"center",prop:"time",label:"操作时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getTime(t.row.time))+" ")]}}])}),e.getAuthorityFunc("check")?n("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){return e.handleClick(t.row)}}},[e._v("查看")])]}}],null,!1,749024663)}):e._e()],1),n("div",{staticClass:"page"},[n("el-pagination",{attrs:{background:"","current-page":e.page,"page-size":e.limit,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleSizeChange,"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t}}})],1)],1)]),n("el-dialog",{attrs:{width:"45%",title:"日志详情",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[e.dialogFormVisible?n("details1",{attrs:{datas:e.datas},on:{func:e.showTree}}):e._e(),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("我知道了")])],1)],1),n("div",{staticClass:"dialog"},[n("el-dialog",{attrs:{title:"配置权限",visible:e.dialogVisible1,width:"1000px","before-close":e.closeDia},on:{"update:visible":function(t){e.dialogVisible1=t}}},[n("div",{staticClass:"minH"},[n("tree-table",{ref:"treeTableO",attrs:{treeData:e.treeData,row:e.row},on:{func:e.initList}})],1),n("span",{staticClass:"dialog-footer",staticStyle:{"text-algin":"center"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){e.dialogVisible1=!1}}},[e._v("我知道了")])],1)])],1)],1)},a=[],c=(n("7db0"),n("45fc"),n("a434"),n("96cf"),n("1da1")),r=n("5530"),s=n("2f62"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"details1"},[n("ul",[n("li",[n("p",[n("span",[e._v("操作板块：")]),n("span",[e._v(e._s(e.datas.plate))])])]),n("li",[n("p",[n("span",[e._v("操作人：")]),n("span",[e._v(e._s(e.datas.user))])])]),n("li",[n("p",[n("span",[e._v("操作时间：")]),n("span",[e._v(e._s(e.getTime(e.datas.time)))])])]),n("li",[n("p",[n("span",[e._v("操作后：")]),n("span",[n("p",[e._v(" "+e._s(1==e.datas.action?"新增":2==e.datas.action?"修改":"删除")+" ")]),"/examine"!=e.datas.plateRouter?n("div",{staticClass:"content",domProps:{innerHTML:e._s(e.contentZh(e.datas.content,2))},on:{click:function(t){e.isSet&&e.showSet(2)}}}):n("div",{staticClass:"content"},[n("el-link",{attrs:{type:"primary"},on:{click:e.goDetails}},[e._v("查看详情")])],1)])])]),2==e.datas.action?n("li",[n("p",[n("span",[e._v("操作前：")]),n("span",["/examine"!=e.datas.plateRouter?n("div",{staticClass:"content",domProps:{innerHTML:e._s(e.contentZh(e.datas.beforeCon,1))},on:{click:function(t){e.isSet&&e.showSet(1)}}}):n("div",{staticClass:"content",domProps:{innerHTML:e._s(e.contentBefore(e.datas.beforeCon))}})])])]):e._e()])])},l=[];n("99af"),n("d3b7"),n("25f0"),n("a4d3"),n("e01a"),n("d28b"),n("3ca3"),n("ddb0");function d(e){return d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}var u=n("a7fe"),h=n("ea5b"),f={name:"details1",data:function(){return{anjianList:[],isSet:!1,old_tree:[],tree:[]}},props:{datas:{type:Object}},components:{treeTable:h["a"]},created:function(){},methods:{goDetails:function(){console.log(this.datas.content);var e=this.datas.content["请进入详情查看"],t=this.$router.resolve({path:"/examineDetails",query:{isPersonal:e.isPersonal,mainsId:e.id}}),n=t.href;window.open(n,"_blank")},showSet:function(e){var t=[];t=1==e?this.old_tree:this.tree,this.$emit("func",t)},getTime:function(e){return this.dayjs(e).format("YYYY-MM-DD HH:mm:ss")},contentZh:function(e,t){var n="";for(var i in e)"设置权限"==i?(this.isSet=!0,n+="<p>".concat(i+":<span style='color: #409EFF;font-size:14px;cursor: pointer;'>查看权限</span>","<p>"),1==t?this.old_tree=JSON.parse(e[i]):this.tree=JSON.parse(e[i])):n+="<p>".concat(i+":"+e[i],"<p>");return n},contentAffter:function(e){var t="";for(var n in e)t+="<p>".concat(n+":"+e[n],"<p>");return t},isJson:function(e){var t="object"==d(e)&&"[object object]"==Object.prototype.toString.call(e).toLowerCase()&&!e.length;return t},contentBefore:function(e){var t="";for(var n in e)if(e[n]instanceof Array&&e[n].length>0)for(var i=0;i<e[n].length;i++)if(this.isJson(e[n][i])){for(var a in e[n][i])if("id"!=a){var c="",r="";if(e[n][i][a]instanceof Array)for(var s=0;s<e[n][i][a].length;s++)r+="<p>".concat(a,':</p><img style="margin-top:8px;max-width:100%;" src="').concat(e[n][i][a][s],'"/>');else c="<p>".concat(a,":").concat(e[n][i][a],"</p>");t+='<div style="margin-bottom:20px">\n                                        '.concat(c,'\n                                        <div style="margin-bottom:10px">\n                                         ').concat(r,"\n                                        </div>\n                                      </div>")}}else t+='<div style="margin-bottom:20px">\n                                <p>'.concat(n,':</p><img style="margin-top:8px;max-width:100%;" src="').concat(e[n][i],'"/>\n                                </div>');else t+='<div style="margin-bottom:20px"><p>'.concat(n,':</p><img style="margin-top:8px;max-width:100%;" src="').concat(e[n],'"/></div>');return t}}},p=f,g=(n("5a8e"),n("2877")),m=Object(g["a"])(p,o,l,!1,null,"059e1f2e",null),v=m.exports,b={name:"journal",data:function(){return{type:"全部",Types:[],time:[],tableData:[],dialogFormVisible:!1,loading:!0,total:0,limit:8,page:1,userName:"",datas:{},treeData:[],_treeData:[],dialogVisible1:!1,row:null}},computed:Object(r["a"])({},Object(s["c"])({getAuthority:"getAuthority"})),components:{details1:v,treeTable:h["a"]},mounted:function(){},created:function(){var e=this;this.getSysmenusList({token:this.$store.state.token,level:2,menu_type_id:1,page:0,page_size:0}).then((function(t){1==t.code?(e.Types=t.data.list,e.Types.splice(0,0,{menu_code:"/",menu_name:"全部",id:0})):e.$message.error(t.msg)})),this.Bind(1)},methods:Object(r["a"])(Object(r["a"])({},Object(s["b"])({getJournalList:"loginModule/getJournalList",getSysmenusList:"loginModule/getSysmenusList"})),{},{getAuthorityFunc:function(e){var t=this;if(this.getAuthority&&0!=this.getAuthority.length){var n=this.getAuthority.find((function(e){return e.code==t.$route.path}));if(n&&n.child&&0!=n.child.length)return n.child.some((function(t){return t.code==e}))}},showTree:function(e){var t=this;if(this.dialogVisible1=!0,this.treeData=JSON.parse(JSON.stringify(e)),this.$nextTick((function(){t.$refs.treeTableO.checkAll=t.treeData.some((function(e){return 1==e.checked}))})),this.treeData&&0==this.treeData.length)return this.$message.warning("暂无内容！")},closeDia:function(){this.dialogVisible1=!1,this.row=null,this.treeData=[],this.$refs.treeTableO.checkAll=!1},initList:function(){console.log("1")},getTime:function(e){return this.dayjs(e).format("YYYY-MM-DD HH:mm:ss")},contentZh:function(e,t){var n="";for(var i in t)n+=i+",";switch(e){case 1:return"<p>新增：</p>"+n;case 2:return"<p>修改:</p>"+n;case 3:return"<p>删除:</p>"+n}},getRQ:function(e){return u["a"].getRQ(e)},Bind:function(e){var t=this;1==e&&(this.page=1),this.loading=!0;var n={page:e,limit:8};""!=this.userName&&null!=this.userName&&(n.user=this.userName),"/"!=this.type&&"全部"!=this.type&&(n.plateRouter=this.type),this.getJournalList(n).then(function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:"success"==n.code?(t.tableData.splice(0,t.tableData.length),t.tableData=n.result.docs,t.total=parseInt(n.result.total),t.limit=8):t.$message.error(n.msg),t.loading=!1;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},handleSizeChange:function(e){this.Bind(e)},handleClick:function(e){this.datas=e,this.dialogFormVisible=!0},Refush:function(){this.userName="",this.type="/",this.Bind(1)},formok:function(){this.dialogFormVisible=!1}})},k=b,y=(n("8125"),Object(g["a"])(k,i,a,!1,null,"089add60",null));t["default"]=y.exports},"45fc":function(e,t,n){"use strict";var i=n("23e7"),a=n("b727").some,c=n("a640"),r=n("ae40"),s=c("some"),o=r("some");i({target:"Array",proto:!0,forced:!s||!o},{some:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},"5a8e":function(e,t,n){"use strict";var i=n("dea6"),a=n.n(i);a.a},"681f":function(e,t,n){},"775e":function(e,t,n){},"7db0":function(e,t,n){"use strict";var i=n("23e7"),a=n("b727").find,c=n("44d2"),r=n("ae40"),s="find",o=!0,l=r(s);s in[]&&Array(1)[s]((function(){o=!1})),i({target:"Array",proto:!0,forced:o||!l},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),c(s)},8125:function(e,t,n){"use strict";var i=n("681f"),a=n.n(i);a.a},a434:function(e,t,n){"use strict";var i=n("23e7"),a=n("23cb"),c=n("a691"),r=n("50c4"),s=n("7b0b"),o=n("65f0"),l=n("8418"),d=n("1dde"),u=n("ae40"),h=d("splice"),f=u("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,g=Math.min,m=9007199254740991,v="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!h||!f},{splice:function(e,t){var n,i,d,u,h,f,b=s(this),k=r(b.length),y=a(e,k),_=arguments.length;if(0===_?n=i=0:1===_?(n=0,i=k-y):(n=_-2,i=g(p(c(t),0),k-y)),k+n-i>m)throw TypeError(v);for(d=o(b,i),u=0;u<i;u++)h=y+u,h in b&&l(d,u,b[h]);if(d.length=i,n<i){for(u=y;u<k-i;u++)h=u+i,f=u+n,h in b?b[f]=b[h]:delete b[f];for(u=k;u>k-i+n;u--)delete b[u-1]}else if(n>i)for(u=k-i;u>y;u--)h=u+i-1,f=u+n-1,h in b?b[f]=b[h]:delete b[f];for(u=0;u<n;u++)b[u+y]=arguments[u+2];return b.length=k-i+n,d}})},a7fe:function(e,t,n){"use strict";n("ac1f"),n("5319");t["a"]={getSJC:function(e){var t=new Date(e),n=t.getFullYear()+"-"+parseInt(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds(),i=new Date(n);i=new Date(n.replace(/-/g,"/"));return Math.round(Date.parse(i)/1e3)},getRQ:function(e){if(""==e||null==e)return"";var t=new Date(parseInt(1e3*e)),n=t.getFullYear(),i=t.getMonth()+1;i=i<10?"0"+i:i;var a=t.getDate();a=a<10?"0"+a:a;var c=t.getHours();c=c<10?"0"+c:c;var r=t.getMinutes(),s=t.getSeconds();r=r<10?"0"+r:r,s=s<10?"0"+s:s;var o=n+"-"+i+"-"+a+"  "+c+":"+r;return o}}},dea6:function(e,t,n){},ea5b:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.treeData&&0!=e.treeData.length?n("div",[e._m(0),n("div",{staticClass:"tableBox"},[n("div",{staticClass:"ord"},e._l(e.treeData,(function(t){return n("div",{key:t.id,staticClass:"box"},[n("div",{staticClass:"fu"},[n("el-checkbox",{attrs:{disabled:e.isSelect},on:{change:function(n){return e.checkedBtn(t)}},model:{value:t.checked,callback:function(n){e.$set(t,"checked",n)},expression:"item.checked"}},[e._v(e._s(t.name))])],1),n("div",{staticClass:"zi"},e._l(t.child,(function(t){return n("div",{key:t.id,staticClass:"item"},[n("div",{staticClass:"er"},[n("el-checkbox",{attrs:{disabled:e.isSelect},on:{change:function(n){return e.checkedBtn(t)}},model:{value:t.checked,callback:function(n){e.$set(t,"checked",n)},expression:"it.checked"}},[e._v(e._s(t.name))])],1),n("div",{staticClass:"opt"},e._l(t.child,(function(t){return n("span",{key:t.id},[n("el-checkbox",{attrs:{disabled:e.isSelect},on:{change:function(n){return e.checkedBtn(t)}},model:{value:t.checked,callback:function(n){e.$set(t,"checked",n)},expression:"its.checked"}},[e._v(e._s(t.name))])],1)})),0)])})),0)])})),0),n("div",{staticClass:"sys"},[n("el-checkbox",{attrs:{disabled:e.isSelect},on:{change:e.checkAllFunc},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("修尔信后台")])],1)])]):n("div",[n("h3",{staticStyle:{"text-align":"center"}},[e._v("暂无内容！")])])])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"head"},[n("ul",[n("li",[e._v("系统")]),n("li",[e._v("一级菜单")]),n("li",[e._v("二级菜单")]),n("li",[e._v("操作")])])])}],c=(n("7db0"),n("4160"),n("45fc"),n("159b"),n("96cf"),n("1da1")),r=n("5530"),s=n("2f62"),o={data:function(){return{checkAll:!1,selectId:[],tree:[],old_tree:[]}},props:["treeData","row","isSelect"],computed:Object(r["a"])({},Object(s["c"])(["getToken"])),created:function(){},methods:Object(r["a"])(Object(r["a"])({},Object(s["b"])({sysrolesUpdate:"loginModule/sysrolesUpdate",insertJournal:"loginModule/insertJournal"})),{},{dab:function(e){var t=[];e.forEach((function(e){e.child&&0!=e.child.length&&(t.push(e),e.child.forEach((function(n){n.pid=e.id,t.push(n),n.child&&0!=n.child.length&&n.child.forEach((function(e){e.pid=n.id,t.push(e)}))})))})),this.treeData.forEach((function(e){t.forEach((function(t){e.id==t.id&&(e.checked=!0),e.child&&0!=e.child.length&&e.child.forEach((function(n){n.id==t.id&&t.pid==e.id&&(n.checked=!0),n.child&&0!=n.child.length&&n.child.forEach((function(e){e.id==t.id&&t.pid==n.id&&(e.checked=!0)}))}))}))})),this.checkAll=this.treeData.some((function(e){return 1==e.checked})),this.old_tree=JSON.parse(JSON.stringify(this.treeData)),this.$forceUpdate()},logOption:function(e,t,n){var i={plate:"角色管理",plateRouter:"/character",user:this.$store.state.userInfo.identity_name,userId:111,action:t,time:new Date,content:e};n&&(i.beforeCon=n),this.insertJournal(i)},sysrolesUpdateFun:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,i,a,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={token:e.getToken,id:e.row.id,role_name:e.row.role_name,check_ids:e.selectId},t.next=3,e.sysrolesUpdate(n);case 3:if(i=t.sent,1==i.code){t.next=6;break}return t.abrupt("return",e.$message.error(i.msg));case 6:e.$message.success("设置成功！"),e.$emit("func"),a={"角色ID":e.row.id,"角色名称":e.row.role_name,"是否启用":1==e.row.status?"启用":"禁用","创建时间":e.row.create_time,"设置权限":JSON.stringify(e.old_tree)},c={"角色ID":e.row.id,"角色名称":e.row.role_name,"是否启用":1==e.row.status?"启用":"禁用","创建时间":e.row.create_time,"设置权限":JSON.stringify(e.tree)},e.logOption(c,2,a);case 11:case"end":return t.stop()}}),t)})))()},getSelectId:function(){var e=this;this.selectId=[],this.treeData.forEach((function(t){if(t.checked){var n={};n.id=t.id,t.child&&0!=t.child.length&&(n.child=[],t.child.forEach((function(e){if(e.checked){var t={};t.id=e.id,e.child&&0!=e.child.length&&(t.child=[],e.child.forEach((function(e){if(e.checked){var n={};n.id=e.id,t.child.push(n)}}))),n.child.push(t)}}))),e.selectId.push(n)}}))},checkedBtn:function(e){this.checkFn(e),1==e.type||(2==e.type?e.checked?this.treeData.find((function(t){return e.pid==t.id})).checked=e.checked:this.treeData.forEach((function(e){e.child&&0!=e.child.length&&(e.checked=e.child.some((function(e){return 1==e.checked})))})):e.checked&&this.treeData.forEach((function(e){e.child.forEach((function(t){if(t.child&&0!=t.child.length){var n=t.child.some((function(e){return 1==e.checked}));n&&(t.checked=!0)}e.child&&0!=e.child.length&&(e.checked=e.child.some((function(e){return 1==e.checked})))}))}))),this.checkAll=this.treeData.some((function(e){return 1==e.checked})),this.tree=JSON.parse(JSON.stringify(this.treeData)),this.getSelectId(),this.$forceUpdate()},checkFn:function(e){var t=this;e.child&&0!=e.child.length&&e.child.forEach((function(n){n.checked=e.checked,t.checkFn(n)}))},checkAllFunc:function(){var e=this;this.treeData.forEach((function(t){t.checked=e.checkAll,e.checkFn(t)})),this.getSelectId(),this.tree=JSON.parse(JSON.stringify(this.treeData))}})},l=o,d=(n("0d46"),n("2877")),u=Object(d["a"])(l,i,a,!1,null,"fcf54800",null);t["a"]=u.exports}}]);
//# sourceMappingURL=chunk-546a226a.eb8ec69f.js.map
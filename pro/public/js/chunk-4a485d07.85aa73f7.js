(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a485d07"],{"353d":function(e,t,r){"use strict";var a=r("630e"),s=r.n(a);s.a},"45fc":function(e,t,r){"use strict";var a=r("23e7"),s=r("b727").some,n=r("a640"),i=r("ae40"),o=n("some"),l=i("some");a({target:"Array",proto:!0,forced:!o||!l},{some:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},"5d75":function(e,t,r){},"630e":function(e,t,r){},"7db0":function(e,t,r){"use strict";var a=r("23e7"),s=r("b727").find,n=r("44d2"),i=r("ae40"),o="find",l=!0,u=i(o);o in[]&&Array(1)[o]((function(){l=!1})),a({target:"Array",proto:!0,forced:l||!u},{find:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),n(o)},d459:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"home_index"},[r("el-card",{staticClass:"myCard",staticStyle:{width:"100%"}},[r("el-form",{ref:"ruleForm",attrs:{"label-position":"left",model:e.ruleForm,inline:!0,"label-width":"100px"}},[r("el-form-item",{staticStyle:{"margin-right":"40px"},attrs:{prop:"name"}},[r("el-input",{attrs:{autocomplete:"off",clearable:"",placeholder:"用户名/账号"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),r("el-form-item",{staticStyle:{"margin-right":"40px"},attrs:{prop:"name"}},[r("el-select",{attrs:{placeholder:"是否启用"},on:{change:e.changeStatus},model:{value:e.ruleForm.status,callback:function(t){e.$set(e.ruleForm,"status",t)},expression:"ruleForm.status"}},[r("el-option",{attrs:{label:"全部",value:"0"}}),e._l(e.options,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],2)],1),r("el-form-item",{staticStyle:{"margin-right":"40px"},attrs:{prop:"name"}},[r("el-select",{attrs:{placeholder:"选择角色"},on:{change:e.changeStatus},model:{value:e.ruleForm.sys_role_id,callback:function(t){e.$set(e.ruleForm,"sys_role_id",t)},expression:"ruleForm.sys_role_id"}},[r("el-option",{attrs:{label:"全部",value:"0"}}),e._l(e.sysrolesList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.role_name,value:e.id}})}))],2)],1),r("el-form-item",{staticStyle:{float:"right"}},[r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("查询")]),e.getAuthorityFunc("create")?r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.addFormFn}},[e._v("新增")]):e._e()],1)],1)],1),r("div",{staticClass:"page_con"},[r("list",{ref:"list",attrs:{name:e.ruleForm.name,status:e.ruleForm.status,sys_role_id:e.ruleForm.sys_role_id,sysrolesList:e.sysrolesList},on:{dataBind:e.dataBind}})],1),r("el-dialog",{attrs:{center:"",title:e.isUpdate?"编辑人员信息":"新增人员信息",visible:e.dialogVisible,width:"576px","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"addRuleForm",staticClass:"add",attrs:{model:e.addRuleForm,rules:e.addRules,"label-width":"120px","label-position":"top"}},[r("el-form-item",{attrs:{label:"用户名称：",prop:"name"}},[r("el-input",{attrs:{autocomplete:"off",clearable:""},model:{value:e.addRuleForm.name,callback:function(t){e.$set(e.addRuleForm,"name",t)},expression:"addRuleForm.name"}})],1),r("el-form-item",{attrs:{label:"用户账号：",prop:"admins"}},[r("el-input",{attrs:{autocomplete:"off",clearable:"",disabled:e.isUpdate},model:{value:e.addRuleForm.admins,callback:function(t){e.$set(e.addRuleForm,"admins",t)},expression:"addRuleForm.admins"}})],1),r("el-form-item",{attrs:{label:"用户密码：",prop:"psws"}},[r("el-input",{attrs:{type:"password",autocomplete:"off",clearable:""},model:{value:e.addRuleForm.psws,callback:function(t){e.$set(e.addRuleForm,"psws",t)},expression:"addRuleForm.psws"}})],1),r("el-form-item",{attrs:{label:"确认密码：",prop:"confirmPassword"}},[r("el-input",{attrs:{type:"password",autocomplete:"off",clearable:""},model:{value:e.addRuleForm.confirmPassword,callback:function(t){e.$set(e.addRuleForm,"confirmPassword",t)},expression:"addRuleForm.confirmPassword"}})],1),r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"用户角色：",prop:"sys_role_id"}},[r("el-select",{attrs:{placeholder:"选择角色"},model:{value:e.addRuleForm.sys_role_id,callback:function(t){e.$set(e.addRuleForm,"sys_role_id",t)},expression:"addRuleForm.sys_role_id"}},e._l(e.sysrolesList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.role_name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"是否启用：",prop:"status"}},[r("el-radio-group",{model:{value:e.addRuleForm.status,callback:function(t){e.$set(e.addRuleForm,"status",t)},expression:"addRuleForm.status"}},[r("el-radio",{attrs:{label:"1"}},[e._v("启用")]),r("el-radio",{attrs:{label:"2"}},[e._v("禁用")])],1)],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.resetForm("addRuleForm")}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.addOrUpdateSysAccount}},[e._v("确 定")])],1)],1)],1)},s=[],n=(r("7db0"),r("45fc"),r("b0c0"),r("96cf"),r("1da1")),i=r("5530"),o=r("2f62"),l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoad,expression:"isLoad"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",border:""},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),r("el-table-column",{attrs:{label:"用户ID",width:"120",prop:"id"}}),r("el-table-column",{attrs:{prop:"name",label:"用户名称","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{prop:"admins",label:"账号","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{prop:"role_name",label:"角色"}}),r("el-table-column",{attrs:{prop:"status",label:"是否启用"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row.status?"启用":"禁用")+" ")]}}])}),r("el-table-column",{attrs:{prop:"create_time",label:"创建时间"}}),e.result(e.getAuthorityFunc("edit"),e.getAuthorityFunc("delete"))?r("el-table-column",{attrs:{prop:"option",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.getAuthorityFunc("edit")?r("el-link",{attrs:{type:"primary"},on:{click:function(r){return e.updateMenu(2,t.row)}}},[e._v("修改")]):e._e(),e.getAuthorityFunc("delete")?r("el-link",{attrs:{type:"primary"},on:{click:function(r){return e.deleteMenu(1,t.row)}}},[e._v("删除")]):e._e()]}}],null,!1,3243005225)}):e._e()],1),r("div",{staticClass:"deleteAll"},[r("div",[e.getAuthorityFunc("edit")?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.changeStatus(1)}}},[e._v("启用")]):e._e(),e.getAuthorityFunc("edit")?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.changeStatus(2)}}},[e._v("禁用")]):e._e(),e.getAuthorityFunc("delete")?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.deleteMenu(2)}}},[e._v("删除")]):e._e()],1)]),r("div",{staticClass:"page_tion"},[r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","page-size":e.size,"current-page":e.page,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},u=[],c=(r("4160"),r("159b"),{data:function(){return{isLoad:!1,page:1,size:10,total:0,tableData:[],multipleSelection:[],deleteList:[],statusChangeList:[]}},props:["name","status","sys_role_id","sysrolesList"],computed:Object(i["a"])({},Object(o["c"])(["getToken","getAuthority"])),created:function(){this.initList(1)},methods:Object(i["a"])(Object(i["a"])({},Object(o["b"])({getAccountList:"loginModule/getAccountList",accountDelete:"loginModule/accountDelete",accountStatusChange:"loginModule/accountStatusChange",insertJournal:"loginModule/insertJournal"})),{},{result:function(e,t){return 0!=e||0!=t},getAuthorityFunc:function(e){var t=this;if(this.getAuthority&&0!=this.getAuthority.length){var r=this.getAuthority.find((function(e){return e.code==t.$route.path}));if(r&&r.child&&0!=r.child.length)return r.child.some((function(t){return t.code==e}))}},changeStatus:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.statusChangeList=[],a=[],t.multipleSelection.forEach((function(e){a.push(e.id),t.statusChangeList.push(e)})),!t.deleteList||0!=t.deleteList.length){r.next=5;break}return r.abrupt("return",t.$message.warning("请选择要更新的人员！"));case 5:return r.prev=5,t.isLoad=!0,s={token:t.getToken,id:a,status:e},r.next=10,t.accountStatusChange(s);case 10:if(n=r.sent,1==n.code){r.next=13;break}return r.abrupt("return",t.$message.error(n.msg));case 13:t.$message({type:"success",message:"修改成功!"}),t.statusChangeList.forEach((function(r){var a={"用户名称":r.name,"账号":r.admins,"角色":r.role_name,"是否启用":1==r.status?"启用":"禁用"},s={"用户名称":r.name,"账号":r.admins,"角色":r.role_name,"是否启用":1==e?"启用":"禁用"};t.logOption(s,2,a)})),r.next=20;break;case 17:r.prev=17,r.t0=r["catch"](5),console.log(r.t0);case 20:return r.prev=20,t.initList(),r.finish(20);case 23:case"end":return r.stop()}}),r,null,[[5,17,20,23]])})))()},updateMenu:function(e,t){this.$emit("dataBind",e,t)},logOption:function(e,t,r){var a={plate:"员工管理",plateRouter:"/personnel",user:this.$store.state.userInfo.identity_name,userId:111,action:t,time:new Date,content:e};r&&(a.beforeCon=r),this.insertJournal(a)},initList:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,1==e&&(t.page=1),t.isLoad=!0,a={token:t.getToken,keywords:t.name,page:t.page,page_size:t.size,status:0==t.status?null:t.status,sys_role_id:0==t.sys_role_id?null:t.sys_role_id},r.next=6,t.getAccountList(a);case 6:if(s=r.sent,1==s.code){r.next=9;break}return r.abrupt("return",t.$message.error(s.msg));case 9:t.tableData=s.data.list,t.total=s.data.count,r.next=17;break;case 13:r.prev=13,r.t0=r["catch"](0),console.log(r.t0),t.initList(e);case 17:return r.prev=17,t.isLoad=!1,r.finish(17);case 20:case"end":return r.stop()}}),r,null,[[0,13,17,20]])})))()},handleSelectionChange:function(e){this.multipleSelection=e},deleteMenu:function(e,t){var r=this;this.deleteList=[];var a=[];if(1==e?(a.push(t.id),this.deleteList.push(t)):this.multipleSelection.forEach((function(e){a.push(e.id),r.deleteList.push(e)})),this.deleteList&&0==this.deleteList.length)return this.$message.warning("请选择要删除的人员！");this.$confirm(1==e?"是否删除该人员？":"是否删除选中人员？","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r.isLoad=!0,t={token:r.getToken,id:a},e.next=5,r.accountDelete(t);case 5:if(s=e.sent,1==s.code){e.next=8;break}return e.abrupt("return",r.$message.error(s.msg));case 8:r.$message({type:"success",message:"删除成功!"}),r.deleteList.forEach((function(e){var t={"用户名称":e.name,"账号":e.admins,"角色":e.role_name,"是否启用":1==e.status?"启用":"禁用"};r.logOption(t,3)})),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](0),console.log(e.t0);case 15:return e.prev=15,r.initList(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})))).catch((function(){r.$message({type:"info",message:"已取消删除"})}))},handleSizeChange:function(e){this.size=e,this.bind()},handleCurrentChange:function(e){this.page=e,this.bind()}})}),d=c,m=(r("db00"),r("2877")),p=Object(m["a"])(d,l,u,!1,null,"304cd55f",null),f=p.exports,h={data:function(){var e=this,t=function(e,t,r){var a=/^[A-Za-z0-9]+$/;a.test(t)?r():r(new Error("密码不能为特殊字符"))},r=function(t,r,a){""===r?a(new Error("请再次输入密码")):r!==e.addRuleForm.psws?a(new Error("两次输入密码不一致!")):a()};return{sysrolesList:[],options:[{value:"1",label:"启用"},{value:"2",label:"禁用"}],dialogVisible:!1,val:"你好",ruleForm:{name:"",status:"",role:""},addRuleForm:{name:"",admins:"",psws:"",confirmPassword:"",sys_role_id:"",status:"1"},addRules:{name:[{required:!0,message:"请输入用户名称",trigger:"blur"}],admins:[{required:!0,message:"请输入用户账号",trigger:"blur"}],psws:[{required:!0,validator:t,trigger:"blur"},{min:6,max:15,message:"长度在 6 到 15 个字符",trigger:"blur"}],confirmPassword:[{required:!0,validator:r,trigger:"blur"},{min:6,max:15,message:"长度在 6 到 15 个字符",trigger:"blur"}],sys_role_id:[{required:!0,message:"请选择角色",trigger:"blur"}],status:[{required:!0,message:"请选择是否禁用",trigger:"blur"}]},oldForm:{},isUpdate:!1}},components:{list:f},created:function(){this.getRolesList()},mounted:function(){},computed:Object(i["a"])({},Object(o["c"])(["getToken","getAuthority"])),methods:Object(i["a"])(Object(i["a"])({},Object(o["b"])({getSysrolesList:"loginModule/getSysrolesList",accountCreate:"loginModule/accountCreate",accountUpdate:"loginModule/accountUpdate",insertJournal:"loginModule/insertJournal"})),{},{getAuthorityFunc:function(e){var t=this;if(this.getAuthority&&0!=this.getAuthority.length){var r=this.getAuthority.find((function(e){return e.code==t.$route.path}));if(r&&r.child&&0!=r.child.length)return r.child.some((function(t){return t.code==e}))}},addFormFn:function(){this.dialogVisible=!0,this.addRuleForm={name:"",admins:"",psws:"",confirmPassword:"",sys_role_id:"",status:"1"}},copyData:function(e){return JSON.parse(JSON.stringify(e))},handleClose:function(){this.dialogVisible=!1,this.isUpdate=!1,this.$refs.addRuleForm.resetFields()},dataBind:function(e,t){this.dialogVisible=!0;var r=this.copyData(t);this.oldForm=this.copyData(r),this.addRuleForm=r,this.addRuleForm.psws=null,this.addRuleForm.sys_role_id=r.sys_role_id,0==this.addRuleForm.sys_role_id&&(this.addRuleForm.sys_role_id=""),this.isUpdate=2==e},getRolesList:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r={token:e.getToken,page:0,page_size:0},t.next=4,e.getSysrolesList(r);case 4:if(a=t.sent,1==a.code){t.next=7;break}return t.abrupt("return",e.$message.error(a.msg));case 7:e.sysrolesList=a.data.list,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},changeStatus:function(){var e=this;this.$nextTick((function(){e.$refs.list.initList()}))},logOption:function(e,t,r){var a={plate:"员工管理",plateRouter:"/personnel",user:this.$store.state.userInfo.identity_name,userId:111,action:t,time:new Date,content:e};r&&(a.beforeCon=r),this.insertJournal(a)},addOrUpdateSysAccount:function(){var e=this;this.$refs.addRuleForm.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){var a,s,n,i,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=36;break}if(e.btnLoad=!0,t.prev=2,a={token:e.getToken,admins:e.addRuleForm.admins,name:e.addRuleForm.name,psws:e.addRuleForm.psws,sys_role_id:e.addRuleForm.sys_role_id,status:e.addRuleForm.status},e.isUpdate&&(a.id=e.addRuleForm.id),!e.isUpdate){t.next=11;break}return t.next=8,e.accountUpdate(a);case 8:t.t0=t.sent,t.next=14;break;case 11:return t.next=13,e.accountCreate(a);case 13:t.t0=t.sent;case 14:if(s=t.t0,1==s.code){t.next=17;break}return t.abrupt("return",e.$message.error(s.msg));case 17:e.$message.success(e.isUpdate?"修改成功!":"添加成功!"),n=e.sysrolesList.find((function(t){return t.id==e.addRuleForm.sys_role_id})),i=e.sysrolesList.find((function(t){return t.id==e.oldForm.sys_role_id})),o={"用户名称":e.addRuleForm.name,"账号":e.addRuleForm.admins,"角色":n.role_name,"是否启用":1==e.addRuleForm.status?"启用":"禁用"},e.isUpdate?(l={"用户名称":e.oldForm.name,"账号":e.oldForm.admins,"角色":i.role_name,"是否启用":1==e.oldForm.status?"启用":"禁用"},e.logOption(o,2,l)):e.logOption(o,1,l),t.next=27;break;case 24:t.prev=24,t.t1=t["catch"](2),console.log(t.t1);case 27:return t.prev=27,e.dialogVisible=!1,e.isUpdate=!1,e.btnLoad=!1,e.$refs.addRuleForm.resetFields(),e.$refs.list.initList(1),t.finish(27);case 34:t.next=38;break;case 36:return console.log("error submit!!"),t.abrupt("return",!1);case 38:case"end":return t.stop()}}),t,null,[[2,24,27,34]])})));return function(e){return t.apply(this,arguments)}}())},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.$refs.list.initList(1)}))},resetForm:function(e,t){var r=this;this.dialogVisible=!1,this.$refs[e].resetFields(),0==t&&this.$nextTick((function(){r.$refs.list.initList(1)}))}})},g=h,b=(r("353d"),Object(m["a"])(g,a,s,!1,null,"2fe8b070",null));t["default"]=b.exports},db00:function(e,t,r){"use strict";var a=r("5d75"),s=r.n(a);s.a}}]);
//# sourceMappingURL=chunk-4a485d07.85aa73f7.js.map